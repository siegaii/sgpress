---
title: Node基础
date: 2021-07-30 18:13:06
permalink: /pages/4a37a8/
categories:
  - 技术文档
  - Node
tags:
  - Node
  - 全栈
---

## 优势

IO 是计算机操作过程中最缓慢的环节，Node适用于IO密集型高并发请求，Nodejs处理IO时优点很多，避免多线程在进行上下轮切换的时候出现的。

<!-- more -->

+ 状态保存
+ 事件消耗
+ 状态锁

::: tip
IO密集型指的是系统的CPU性能相对硬盘、内存要好很多，此时，系统运作，大部分的状况是CPU在等I/O (硬盘/内存) 的读/写操作，此时CPU Loading并不高
CPU密集型也叫计算密集型，指的是系统的硬盘、内存性能相对CPU要好很多，此时，系统运作大部分的状况是CPU Loading 100%，CPU要读/写I/O(硬盘/内存)，I/O在很短的时间就可以完成，而CPU还有许多运算要处理，CPU Loading很高。
:::

::: tip
Reactor 模式（应答者模式），单线程完成多线程工作
Reactor模式下实现异步IO、事件驱动。
:::

## 异步IO
+ IO 是应用程序的瓶颈所在
+ 异步IO提高性能 无须 原地等待结果返回
+ IO 操作属于操作系统级别，平台都有对应实现
+ Nodejs 单线程配合事件驱动架构及libuv 实现了异步IO

::: tip
常用轮询技术有: read, select, poll, kqueue, event ports。轮询仍然时同步的效果。
:::

## 事件驱动架构

![](/sgpress/img/事件驱动.png)

#### 事件驱动，发布订阅，观察者
共同特征： 发布者广播消息，其它实例接受消息

## 单线程
优点：减少线程切换时出现的cpu开销，和内存同步开销。
缺点：处理cpu密集型任务时过多的占用cpu（node 中有集群的一些解决方案）

### 单线程如何实现高并发

node底层通过，异步IO、事件循环 配合事件驱动的架构，去通过回调通知的方式来实现非阻塞的调用以及做到并发

### Nodejs 主线程是单线程
js平台下的js代码主要都是由V8来执行的，在V8当中只有一个主线程来执行我们的js代码。

::: tip
但Node引擎不是单线程的  
在libuv库当中是存在一个线程池的，默认的情况下它的里面是由4个线程。
node 程序的异步请求可以先分为 网络IO，和非网络IO，和非IO 的一些异步操作。
• 网络IO libuv 会调用当前平台下的相对应的IO接口，去进行处理。
• 另外的两种情况回去使用线程池中的线程进行IO处理。
• 如果觉得这4个线程不够用，可以去修改响应的线程配置。
:::

### Node 应用
node 更加适合IO密集型任务

+ Node.js 作为中间层
+ 操作数据库提供API服务
+ 实时聊天应用程序
+ 前端工程化